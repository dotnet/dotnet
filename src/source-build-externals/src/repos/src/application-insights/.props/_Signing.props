<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Target Name="Info_SigningProps"  BeforeTargets="Build" Condition=" $(Internal_Logging) == 'true' ">
    <Message Text="Info: Signing.props imported by $(MSBuildProjectName)." Importance="high"/>
  </Target>

  <PropertyGroup>
    <SignAssembly>true</SignAssembly>
    <PublicSign Condition=" '$(OS)' != 'Windows_NT' ">true</PublicSign>
    <AssemblyOriginatorKeyFile>$(KeysRoot)\InternalKey.snk</AssemblyOriginatorKeyFile>
  </PropertyGroup>

  <PropertyGroup Condition="'$(PublicRelease)' == 'True'">
    <DefineConstants>$(DefineConstants);PUBLIC_RELEASE</DefineConstants>
    <SignAssembly>true</SignAssembly>
    <DelaySign>true</DelaySign>
    <AssemblyOriginatorKeyFile>$(KeysRoot)\35MSSharedLib1024.snk</AssemblyOriginatorKeyFile>
  </PropertyGroup>

  <Target Name="AddToSign" AfterTargets="CopyFilesToOutputDirectory" >

    <ItemGroup>
      <!-- Automatically sign binary generated by the project that imports Signing.props -->
      <FilesToSign Include="$(TargetPath)" >
        <Authenticode>Microsoft400</Authenticode>
        <StrongName>MsSharedLib72</StrongName>
      </FilesToSign>

      <!-- If a script is included in a nupkg, it must be signed. -->
      <FilesToSign Include="$(OutputPath)*.ps1">
        <Authenticode>Microsoft400</Authenticode>
        <StrongName>10006</StrongName>
      </FilesToSign>
    </ItemGroup>

    <Message Text="FilesToSign: %(FilesToSign.Identity); %(FilesToSign.Authenticode); %(FilesToSign.StrongName)" Importance="high"/>
  </Target>
</Project>
